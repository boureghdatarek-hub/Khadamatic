<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø®Ø¯Ù…Ø§ØªÙŠ - ØªØ³ÙˆÙ‚ Ù…Ù†Ø²Ù„ÙŠ</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f8f9fa; margin: 0; padding: 20px; text-align: center; }
        .container { max-width: 600px; margin: auto; padding-bottom: 120px; }
        h1 { color: #2d3436; margin-bottom: 20px; }
        .section-title { background: #27ae60; color: white; padding: 12px; border-radius: 8px; margin: 25px 0 10px 0; font-weight: bold; }
        .card { background: white; padding: 15px; margin: 10px 0; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; border: 1px solid #eee; }
        .product-info { text-align: right; }
        .price { color: #e67e22; font-weight: bold; font-size: 1.1em; }
        .btn-add { background: #2ecc71; color: white; border: none; padding: 10px 18px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .input-field { width: 90%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 1em; }
        #cart-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #2d3436; color: white; padding: 20px; text-align: center; font-size: 1.3em; display: none; cursor: pointer; z-index: 1000; }
        #loading { background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; color: #856404; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ¥¦ Ù…Ù†ØµØ© Ø®Ø¯Ù…Ø§ØªÙŠ Ù„Ù„ØªØ³ÙˆÙ‚ ğŸ</h1>
    <div id="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>

    <div class="section-title">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„</div>
    <div class="card" style="display: block;">
        <input type="text" id="customer-name" class="input-field" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">
        <input type="text" id="customer-address" class="input-field" placeholder="Ø§ÙƒØªØ¨ Ø¹Ù†ÙˆØ§Ù†Ùƒ Ø¨Ø§Ù„ØªÙØµÙŠÙ„">
    </div>

    <div id="products-list"></div>

    <div class="section-title">Ø§Ù„Ù…ÙˆØµÙ„ÙŠÙ† Ø§Ù„Ù…ØªØ§Ø­ÙŠÙ†</div>
    <div id="deliverers-list"></div>
</div>

<div id="cart-bar" onclick="sendOrder()">
     Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨: <span id="total-price">0</span> Ø¯Ø¬ | Ø£Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ù…ÙˆØµÙ„ Ø§Ù„Ø¢Ù† ğŸ›’
</div>

<script>
    // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø°ÙŠ Ù†Ø¬Ø­ Ø³Ø§Ø¨Ù‚Ø§Ù‹
    const scriptURL = "https://script.google.com/macros/s/AKfycby19aP00fcc10njWFiUfA-7Xqv_O8wANzfQ1foFoxWMTDGTa2EfoTC2D1GdR58waYAedQ/exec"; 
    
    let cart = [];
    let total = 0;
    let selectedDelivererPhone = "";

    fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
            document.getElementById('loading').style.display = 'none';
            let html = '';
            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            const allProducts = data.veg.concat(data.fruit);
            allProducts.forEach(item => {
                html += `<div class="card">
                    <div class="product-info"><strong>${item[0]}</strong><br><span class="price">${item[2]} Ø¯Ø¬ / ${item[1]}</span></div>
                    <button class="btn-add" onclick="addToCart('${item[0]}', ${item[2]})">Ø¥Ø¶Ø§ÙØ© +</button>
                </div>`;
            });
            document.getElementById('products-list').innerHTML = html;

            let delHtml = '';
            data.delivery.forEach(del => {
                // del[2]=Ø§Ù„Ø§Ø³Ù…ØŒ del[1]=Ø§Ù„Ù‡Ø§ØªÙ
                delHtml += `<div class="card" onclick="selectDeliverer('${del[1]}', '${del[2]}')" style="cursor:pointer;">
                    <div class="product-info"><strong>ğŸšš ${del[2]}</strong><br><small>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${del[0]}</small></div>
                    <small id="status-${del[1]}">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØµÙ„</small>
                </div>`;
            });
            document.getElementById('deliverers-list').innerHTML = delHtml;
        })
        .catch(err => document.getElementById('loading').innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¬Ø¯ÙˆÙ„!");

    function addToCart(name, price) {
        cart.push(name);
        total += price;
        document.getElementById('total-price').innerText = total;
        document.getElementById('cart-bar').style.display = 'block';
    }

    function selectDeliverer(phone, name) {
        selectedDelivererPhone = phone;
        alert("Ù„Ù‚Ø¯ Ø§Ø®ØªØ±Øª Ø§Ù„Ù…ÙˆØµÙ„: " + name);
    }

    function sendOrder() {
        const name = document.getElementById('customer-name').value;
        const address = document.getElementById('customer-address').value;

        if (!name || !address) return alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ ÙˆØ¹Ù†ÙˆØ§Ù†Ùƒ!");
        if (!selectedDelivererPhone) return alert("Ø§Ø®ØªØ± Ù…ÙˆØµÙ„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„!");

        let message = `ğŸ”” *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯*\nğŸ‘¤ *Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${name}\nğŸ“ *Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:* ${address}\nğŸ›’ *Ø§Ù„Ø·Ù„Ø¨Ø§Øª:* \n- ${cart.join("\n- ")}\nğŸ’° *Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:* ${total} Ø¯Ø¬`;
        
        window.open(`https://wa.me/213${selectedDelivererPhone}?text=${encodeURIComponent(message)}`);
    }
</script>
</body>
</html>
